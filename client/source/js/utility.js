(()=>{var L=Object.defineProperty;var o=(e,t)=>L(e,"name",{value:t,configurable:!0});var a=Object.getPrototypeOf,c,y,u,f,P={isConnected:1},F=1e3,g,K={},R=a(P),C=a(a),d,T=o((e,t,l,r)=>(e??(setTimeout(l,r),new Set)).add(t),"addAndScheduleOnFirst"),A=o((e,t,l)=>{let r=u;u=t;try{return e(l)}catch(n){return console.error(n),l}finally{u=r}},"runAndCaptureDeps"),w=o(e=>e.filter(t=>t._dom?.isConnected),"keepConnected"),j=o(e=>g=T(g,e,()=>{for(let t of g)t._bindings=w(t._bindings),t._listeners=w(t._listeners);g=d},F),"addStatesToGc"),m={get val(){return u?._getters?.add(this),this.rawVal},get oldVal(){return u?._getters?.add(this),this._oldVal},set val(e){u?._setters?.add(this),e!==this.rawVal&&(this.rawVal=e,this._bindings.length+this._listeners.length?(y?.add(this),c=T(c,this,q)):this._oldVal=e)}},E=o(e=>({__proto__:m,rawVal:e,_oldVal:e,_bindings:[],_listeners:[]}),"state"),h=o((e,t)=>{let l={_getters:new Set,_setters:new Set},r={f:e},n=f;f=[];let s=A(e,l,t);s=(s??document).nodeType?s:new Text(s);for(let i of l._getters)l._setters.has(i)||(j(i),i._bindings.push(r));for(let i of f)i._dom=s;return f=n,r._dom=s},"bind"),v=o((e,t=E(),l)=>{let r={_getters:new Set,_setters:new Set},n={f:e,s:t};n._dom=l??f?.push(n)??P,t.val=A(e,r,t.rawVal);for(let s of r._getters)r._setters.has(s)||(j(s),s._listeners.push(n));return t},"derive"),M=o((e,...t)=>{for(let l of t.flat(1/0)){let r=a(l??0),n=r===m?h(()=>l.val):r===C?h(l):l;n!=d&&e.append(n)}return e},"add"),N=o((e,t,...l)=>{let[r,...n]=a(l[0]??0)===R?l:[{},...l],s=e?document.createElementNS(e,t):document.createElement(t);for(let[i,p]of Object.entries(r)){let S=o(_=>_?Object.getOwnPropertyDescriptor(_,i)??S(a(_)):d,"getPropDescriptor"),G=t+","+i,V=K[G]??=S(a(s))?.set??0,D=i.startsWith("on")?(_,I)=>{let x=i.slice(2);s.removeEventListener(x,I),s.addEventListener(x,_)}:V?V.bind(s):s.setAttribute.bind(s,i),b=a(p??0);i.startsWith("on")||b===C&&(p=v(p),b=m),b===m?h(()=>(D(p.val,p._oldVal),s)):D(p)}return M(s,n)},"tag"),O=o(e=>({get:o((t,l)=>N.bind(d,e,l),"get")}),"handler"),W=o((e,t)=>t?t!==e&&e.replaceWith(t):e.remove(),"update"),q=o(()=>{let e=0,t=[...c].filter(r=>r.rawVal!==r._oldVal);do{y=new Set;for(let r of new Set(t.flatMap(n=>n._listeners=w(n._listeners))))v(r.f,r.s,r._dom),r._dom=d}while(++e<100&&(t=[...y]).length);let l=[...c].filter(r=>r.rawVal!==r._oldVal);c=d;for(let r of new Set(l.flatMap(n=>n._bindings=w(n._bindings))))W(r._dom,h(r.f,r._dom)),r._dom=d;for(let r of l)r._oldVal=r.rawVal},"updateDoms"),k={tags:new Proxy(e=>new Proxy(N,O(e)),O()),hydrate:o((e,t)=>W(e,h(t,e)),"hydrate"),add:M,state:E,derive:v};function Q(e,t){let l;return function(){let r=this,n=arguments;clearTimeout(l),l=setTimeout(()=>e.apply(r,n),t)}}o(Q,"Dbounce");function U(e,t){let l=0;return function(){if(Date.now()-l>t)return l=Date.now(),e.apply(this,arguments)}}o(U,"throttle");function X(e,t,l){let r=[];if(l&&(r[0]=l),t||(t="span"),Array.isArray(e)){let n=e.length,s=n;for(;n;--n)r.push(e[s-n])}else r.push(e);return k.tags[t].apply(null,r)}o(X,"htm");function Y(e){return new Promise(t=>setTimeout(t,e))}o(Y,"sleep");})();
